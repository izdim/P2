import requests
from pprint import pprint
import random
import docx  # manually add to project or py-chram will install the wrong thing

mn_park_list_url = 'https://mn-state-parks.herokuapp.com/api/list'

mn_park_list_response = requests.get(mn_park_list_url).json()
pprint(mn_park_list_response)

random_park_choices = random.sample(mn_park_list_response, 5)
pprint(random_park_choices)

park_guide_document = docx.Document()

mn_park_id_num = ' https://mn-state-parks.herokuapp.com/api/'
for park_choice in random_park_choices:
    # for every park, in this list
    print(park_choice)
    park_name = park_choice['name']
    print(park_name)
    park_guide_document.add_paragraph(park_name)
    park_id = park_choice['park_id']
    print(park_id)

    park_id_num_url = f'https://mn-state-parks.herokuapp.com/api/{park_id}'
    park_details_response = requests.get(park_id_num_url).json()
    pprint(park_details_response)

    park_address = park_details_response['address']
    park_guide_document.add_paragraph(park_address)

    park_highlight_list = park_details_response['highlights']
    print(park_highlight_list)
    park_guide_document.add_paragraph(park_highlight_list, 'List Bullet')
    for highlight in park_highlight_list:
        park_guide_document.add_paragraph(highlight, 'List Bullet')

park_guide_document.save('MN Park Lists.docx')
